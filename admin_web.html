<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dashboard Admin – Au Format</title>
  
  <link rel="icon" href="/sources/img/logo_tmp.png" type="image/png">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <link rel="stylesheet" href="/sources/css/style_global.css">
  <link rel="stylesheet" href="/sources/css/style_admin_web.css">
  <link rel="stylesheet" href="/sources/css/style_logout_modal.css">

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script defer src="/js/config.js"></script>
  <script defer src="/js/auth.js"></script>
  <script defer src="/js/activity-logger.js"></script>
  <script defer src="/js/logout-modal.js"></script>
</head>

<body>
  <!-- ✅ Header Admin personnalisé en haut -->
  <header class="admin-top-header">
    <div class="admin-top-header-content">
      <div class="admin-top-logo">
        <img src="/sources/img/logo_tmp.png" alt="Au Format">
        <span class="admin-top-title">Au Format - Admin</span>
      </div>
      <nav class="admin-top-nav">
        <a href="/">🏠 Retour au site</a>
        <a href="/profile.html">👤 Mon profil</a>
        <a href="#" onclick="AUTH.logout(); return false;">🚪 Déconnexion</a>
      </nav>
    </div>
  </header>

  <!-- Sidebar -->
  <aside class="admin-sidebar" id="admin-sidebar">
    <div class="sidebar-header">
      <div class="sidebar-logo">
        <img src="/sources/img/logo_tmp.png" alt="Au Format">
        <div>
          <div class="sidebar-title">Au Format</div>
          <div class="admin-badge">⚡ ADMIN</div>
        </div>
      </div>
    </div>

    <nav class="sidebar-nav">
      <div class="nav-section-title">Tableau de bord</div>
      <a href="/admin_web.html" class="nav-link active">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="3" width="7" height="7"></rect>
          <rect x="14" y="3" width="7" height="7"></rect>
          <rect x="14" y="14" width="7" height="7"></rect>
          <rect x="3" y="14" width="7" height="7"></rect>
        </svg>
        Vue d'ensemble
      </a>

      <div class="nav-section-title">Gestion</div>
      <a href="/admin_clients.html" class="nav-link">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
          <circle cx="9" cy="7" r="4"></circle>
          <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
          <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
        </svg>
        Clients
      </a>

      <a href="/admin_quotes.html" class="nav-link">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
        </svg>
        Devis
        <span class="nav-link-badge" id="pending-quotes-count">0</span>
      </a>

      <a href="/admin_projects.html" class="nav-link">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
        </svg>
        Projets
      </a>

      <div class="nav-section-title">Paramètres</div>
      <a href="/admin_settings.html" class="nav-link">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="3"></circle>
          <path d="M12 1v6m0 6v6M5.6 5.6l4.2 4.2m4.2 4.2l4.2 4.2M1 12h6m6 0h6M5.6 18.4l4.2-4.2m4.2-4.2l4.2-4.2"></path>
        </svg>
        Configuration
      </a>

      <a href="/admin_logs.html" class="nav-link">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="12" y1="18" x2="12" y2="12"></line>
          <line x1="9" y1="15" x2="15" y2="15"></line>
        </svg>
        Logs d'activité
      </a>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="admin-content">
    <div class="admin-header">
      <div>
        <h1>📊 Dashboard Admin</h1>
        <p style="color: #64748b; margin-top: 8px;">Vue d'ensemble de votre activité</p>
      </div>
      <div class="admin-header-actions">
        <button class="btn btn-secondary" onclick="refreshDashboard()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="23 4 23 10 17 10"></polyline>
            <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
          </svg>
          Actualiser
        </button>
        <button class="btn btn-primary" onclick="window.location.href='/admin_quotes.html?action=new'">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
          Nouveau devis
        </button>
      </div>
    </div>

    <!-- Stats Cards -->
    <div class="stats-grid">
      <!-- ... vos stats cards ... -->
      <div class="stat-card" style="--stat-color-from: #3b82f6; --stat-color-to: #2563eb;">
        <div class="stat-card-header">
          <div>
            <div class="stat-label">Clients Total</div>
            <div class="stat-value" id="stat-clients">-</div>
            <div class="stat-change positive">
              <span>↗</span> +12% ce mois
            </div>
          </div>
          <div class="stat-icon">👥</div>
        </div>
      </div>

      <div class="stat-card" style="--stat-color-from: #f59e0b; --stat-color-to: #d97706;">
        <div class="stat-card-header">
          <div>
            <div class="stat-label">Devis en attente</div>
            <div class="stat-value" id="stat-pending-quotes">-</div>
            <div class="stat-change">
              <span>→</span> 3 aujourd'hui
            </div>
          </div>
          <div class="stat-icon">📄</div>
        </div>
      </div>

      <div class="stat-card" style="--stat-color-from: #10b981; --stat-color-to: #059669;">
        <div class="stat-card-header">
          <div>
            <div class="stat-label">CA du mois</div>
            <div class="stat-value" id="stat-monthly-revenue">-</div>
            <div class="stat-change positive">
              <span>↗</span> +23% vs mois dernier
            </div>
          </div>
          <div class="stat-icon">💰</div>
        </div>
      </div>

      <div class="stat-card" style="--stat-color-from: #8b5cf6; --stat-color-to: #7c3aed;">
        <div class="stat-card-header">
          <div>
            <div class="stat-label">Projets actifs</div>
            <div class="stat-value" id="stat-active-projects">-</div>
            <div class="stat-change positive">
              <span>↗</span> +5 cette semaine
            </div>
          </div>
          <div class="stat-icon">🚀</div>
        </div>
      </div>

      <div class="stat-card" style="--stat-color-from: #ec4899; --stat-color-to: #db2777;">
        <div class="stat-card-header">
          <div>
            <div class="stat-label">Commandes</div>
            <div class="stat-value" id="stat-total-orders">-</div>
            <div class="stat-change positive">
              <span>↗</span> Taux: 78%
            </div>
          </div>
          <div class="stat-icon">📦</div>
        </div>
      </div>

      <div class="stat-card" style="--stat-color-from: #06b6d4; --stat-color-to: #0891b2;">
        <div class="stat-card-header">
          <div>
            <div class="stat-label">Taux conversion</div>
            <div class="stat-value" style="font-size: 28px;">78%</div>
            <div class="stat-change positive">
              <span>↗</span> +8% ce mois
            </div>
          </div>
          <div class="stat-icon">📈</div>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
      <div class="quick-action-card" onclick="window.location.href='/admin_clients.html'">
        <div class="quick-action-icon">👥</div>
        <div class="quick-action-label">Gérer les clients</div>
      </div>
      <div class="quick-action-card" onclick="window.location.href='/admin_quotes.html?action=new'">
        <div class="quick-action-icon">📝</div>
        <div class="quick-action-label">Créer un devis</div>
      </div>
      <div class="quick-action-card" onclick="window.location.href='/admin_projects.html'">
        <div class="quick-action-icon">📂</div>
        <div class="quick-action-label">Voir les projets</div>
      </div>
      <div class="quick-action-card" onclick="exportData()">
        <div class="quick-action-icon">📊</div>
        <div class="quick-action-label">Export données</div>
      </div>
    </div>

    <!-- Recent Activity -->
    <div class="chart-card">
      <div class="chart-header">
        <h3 class="chart-title">🕐 Activité récente</h3>
        <button class="btn btn-secondary" style="padding: 8px 16px; font-size: 13px;" onclick="window.location.href='/admin_logs.html'">
          Voir tout
        </button>
      </div>
      <div class="activity-list" id="activity-list">
        <p style="text-align: center; color: #94a3b8; padding: 20px;">Chargement de l'activité...</p>
      </div>
    </div>
  </main>

  <script src="/js/admin_web.js"></script>
</body>
</html>