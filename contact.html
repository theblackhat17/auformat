<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Contact ‚Äî Au Format</title>
  <meta name="description" content="Demandez votre devis gratuit : menuiserie et agencement bois √† Cysoing.">
  <link rel="canonical" href="https://auformat.fr/contact.html">

  <meta property="og:title" content="Contact ‚Äî Au Format">
  <meta property="og:description" content="Parlons de votre projet.">
  <meta property="og:url" content="https://auformat.fr/contact.html">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="theme-color" content="#2C5F2D">

  <link rel="stylesheet" href="/sources/css/style_global.css">
  <link rel="stylesheet" href="/sources/css/style_contact.css">
  <link rel="stylesheet" href="/sources/css/style_header.css">  


  <link rel="icon" href="/sources/img/logo_tmp.png" type="image/png">
  <link rel="apple-touch-icon" href="/sources/img/logo_tmp.png">
  <!-- Supabase -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<!-- Vos scripts d'auth -->
<script defer src="/js/config.js"></script>
<script defer src="/js/auth.js"></script>
<script defer src="/js/header-auth.js"></script>
<script defer src="/js/include.js"></script>
</head>

<body>
    <!-- Header -->
    <div data-include="partials/header.html"></div>

    <!-- Hero Section -->
    <section class="page-hero">
        <div>
            <h1>Contactez-Nous</h1>
            <p>Parlons de votre projet et obtenez un devis gratuit</p>
        </div>
    </section>

    <!-- Contact Section -->
    <section class="contact-section">
        <div class="contact-container">
            <!-- Formulaire (STATIQUE) -->
            <div class="form-container">
                <div class="form-header">
                    <h2>Demande de Devis Gratuit</h2>
                    <p>Remplissez ce formulaire et nous vous r√©pondrons sous 24h</p>
                </div>

                <div class="success-message" id="successMessage">
                    ‚úì Votre demande a √©t√© envoy√©e avec succ√®s ! Nous vous recontacterons rapidement.
                </div>

                <form id="contactForm">
                    <!-- Identit√© -->
                    <div class="form-row">
                        <div class="form-group">
                            <label>Nom <span class="required">*</span></label>
                            <input type="text" name="nom" required placeholder="Votre nom">
                        </div>
                        <div class="form-group">
                            <label>Pr√©nom <span class="required">*</span></label>
                            <input type="text" name="prenom" required placeholder="Votre pr√©nom">
                        </div>
                    </div>

                    <!-- Contact -->
                    <div class="form-row">
                        <div class="form-group">
                            <label>Email <span class="required">*</span></label>
                            <input type="email" name="email" required placeholder="votre@email.com">
                        </div>
                        <div class="form-group">
                            <label>T√©l√©phone <span class="required">*</span></label>
                            <input type="tel" name="telephone" required placeholder="06 12 34 56 78">
                        </div>
                    </div>

                    <!-- Localisation -->
                    <div class="form-row">
                        <div class="form-group">
                            <label>Ville <span class="required">*</span></label>
                            <input type="text" name="ville" required placeholder="Lille">
                        </div>
                        <div class="form-group">
                            <label>Code Postal <span class="required">*</span></label>
                            <input type="text" name="cp" required placeholder="59000">
                        </div>
                    </div>

                    <!-- Type de projet -->
                    <div class="form-group">
                        <label>Type de Projet <span class="required">*</span></label>
                        <select name="type_projet" required>
                            <option value="">-- S√©lectionnez --</option>
                            <option value="cuisine">Cuisine sur-mesure</option>
                            <option value="dressing">Dressing / Placard</option>
                            <option value="bibliotheque">Biblioth√®que / Meuble TV</option>
                            <option value="escalier">Escalier</option>
                            <option value="commercial">Agencement commercial</option>
                            <option value="exterieur">Menuiserie ext√©rieure</option>
                            <option value="autre">Autre projet</option>
                        </select>
                    </div>

                    <!-- Budget -->
                    <div class="form-group">
                        <label>Budget Pr√©visionnel</label>
                        <select name="budget">
                            <option value="">-- Facultatif --</option>
                            <option value="moins_5000">Moins de 5 000 ‚Ç¨</option>
                            <option value="5000_10000">5 000 ‚Ç¨ - 10 000 ‚Ç¨</option>
                            <option value="10000_20000">10 000 ‚Ç¨ - 20 000 ‚Ç¨</option>
                            <option value="20000_30000">20 000 ‚Ç¨ - 30 000 ‚Ç¨</option>
                            <option value="plus_30000">Plus de 30 000 ‚Ç¨</option>
                        </select>
                    </div>

                    <!-- D√©lai -->
                    <div class="form-group">
                        <label>D√©lai Souhait√©</label>
                        <select name="delai">
                            <option value="">-- Facultatif --</option>
                            <option value="urgent">Urgent (moins d'1 mois)</option>
                            <option value="1_3mois">1 √† 3 mois</option>
                            <option value="3_6mois">3 √† 6 mois</option>
                            <option value="plus_6mois">Plus de 6 mois</option>
                        </select>
                    </div>

                    <!-- Message -->
                    <div class="form-group">
                        <label>D√©crivez Votre Projet <span class="required">*</span></label>
                        <textarea name="message" required placeholder="D√©crivez-nous votre projet en quelques lignes : dimensions, mat√©riaux souhait√©s, style, contraintes particuli√®res..."></textarea>
                    </div>

                    <!-- RGPD -->
                    <div class="checkbox-group">
                        <input type="checkbox" id="rgpd" name="rgpd" required>
                        <label for="rgpd">
                            J'accepte que mes donn√©es soient utilis√©es pour traiter ma demande de devis.
                        </label>
                    </div>

                    <!-- Submit -->
                    <button type="submit" class="submit-btn">
                        Envoyer ma demande de devis
                    </button>
                </form>
            </div>

            <!-- Info Contact (DYNAMIQUE depuis CMS) -->
            <div class="contact-info">
                <!-- Coordonn√©es -->
                <div class="info-card">
                    <h3><span class="info-icon">üìç</span> Nos Coordonn√©es</h3>
                    
                    <div class="info-item">
                        <div class="info-item-icon">üè¢</div>
                        <div class="info-item-content">
                            <h4>Adresse</h4>
                            <p data-contact="address">Chargement...</p>
                        </div>
                    </div>

                    <div class="info-item">
                        <div class="info-item-icon">üìû</div>
                        <div class="info-item-content">
                            <h4>T√©l√©phone</h4>
                            <p><a href="tel:" id="phone-link" data-contact="phone">Chargement...</a></p>
                        </div>
                    </div>

                    <div class="info-item">
                        <div class="info-item-icon">‚úâÔ∏è</div>
                        <div class="info-item-content">
                            <h4>Email</h4>
                            <p><a href="mailto:" id="email-link" data-contact="email">Chargement...</a></p>
                        </div>
                    </div>

                    <div class="info-item">
                        <div class="info-item-icon">üïê</div>
                        <div class="info-item-content">
                            <h4>Horaires</h4>
                            <div data-contact="hours">
                                <p>Chargement...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Actions Rapides -->
                <div class="quick-actions">
                    <h3>Contactez-nous directement</h3>
                    
                    <a href="tel:" id="call-btn" class="action-btn">
                        <span class="action-icon">üìû</span>
                        <span>Appelez-nous</span>
                    </a>

                    <a href="https://wa.me/" id="whatsapp-btn" class="action-btn" target="_blank">
                        <span class="action-icon">üí¨</span>
                        <span>WhatsApp</span>
                    </a>

                    <a href="mailto:" id="mailto-btn" class="action-btn">
                        <span class="action-icon">‚úâÔ∏è</span>
                        <span>Email</span>
                    </a>
                </div>

                <!-- Infos suppl√©mentaires -->
                <div class="info-card">
                    <h3><span class="info-icon">‚ÑπÔ∏è</span> Bon √† Savoir</h3>
                    
                    <div class="info-item">
                        <div class="info-item-icon">‚ö°</div>
                        <div class="info-item-content">
                            <h4>R√©ponse Rapide</h4>
                            <p>Nous r√©pondons √† toutes les demandes sous 24h ouvr√©es</p>
                        </div>
                    </div>

                    <div class="info-item">
                        <div class="info-item-icon">üè†</div>
                        <div class="info-item-content">
                            <h4>Visite Gratuite</h4>
                            <p>D√©placement gratuit dans la r√©gion pour √©tudier votre projet</p>
                        </div>
                    </div>

                    <div class="info-item">
                        <div class="info-item-icon">üí∞</div>
                        <div class="info-item-content">
                            <h4>Devis Gratuit</h4>
                            <p>√âtude et devis d√©taill√© sans engagement</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section">
        <h2>Pr√™t √† Concr√©tiser Votre Projet ?</h2>
        <p>Demandez votre devis gratuit d√®s maintenant</p>
        <a href="#contactForm" class="btn btn-primary">Remplir le formulaire</a>
    </section>

    <!-- Footer -->
    <div data-include="partials/footer.html"></div>

    <!-- Netlify Identity Widget -->
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

    <!-- Script pour charger le contenu depuis le CMS -->
    <script src="js/load-content.js"></script>

    <!-- Script pour inclure header/footer -->
    <script src="js/include.js" defer></script>

    <!-- Script principal -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Charger les informations de contact depuis le CMS
            loadContactInfo();
            
            // Gestion du formulaire
            setupContactForm();
            
            // Animations
            initAnimations();
        });

        // Fonction pour charger les infos de contact
        async function loadContactInfo() {
            try {
                const response = await fetch('/api/settings/general.json');
                const settings = await response.json();

                // Adresse
                const addressEl = document.querySelector('[data-contact="address"]');
                if (addressEl && settings.address) {
                    addressEl.textContent = `${settings.address}, ${settings.zipcode} ${settings.city}`;
                }

                // T√©l√©phone
                const phoneEl = document.querySelector('[data-contact="phone"]');
                const phoneLink = document.getElementById('phone-link');
                const callBtn = document.getElementById('call-btn');
                if (settings.phone) {
                    const cleanPhone = settings.phone.replace(/\s/g, '');
                    if (phoneEl) phoneEl.textContent = settings.phone;
                    if (phoneLink) {
                        phoneLink.textContent = settings.phone;
                        phoneLink.href = `tel:${cleanPhone}`;
                    }
                    if (callBtn) callBtn.href = `tel:${cleanPhone}`;
                }

                // Email
                const emailEl = document.querySelector('[data-contact="email"]');
                const emailLink = document.getElementById('email-link');
                const mailtoBtn = document.getElementById('mailto-btn');
                if (settings.email) {
                    if (emailEl) emailEl.textContent = settings.email;
                    if (emailLink) {
                        emailLink.textContent = settings.email;
                        emailLink.href = `mailto:${settings.email}`;
                    }
                    if (mailtoBtn) mailtoBtn.href = `mailto:${settings.email}`;
                }

                // Horaires
                const hoursEl = document.querySelector('[data-contact="hours"]');
                if (hoursEl && settings.hours) {
                    hoursEl.innerHTML = `
                        <p>Lun - Ven : ${settings.hours.weekdays || '8h - 18h'}</p>
                        <p>Sam : ${settings.hours.saturday || 'Ferm√©'}</p>
                        <p>Dim : ${settings.hours.sunday || 'Ferm√©'}</p>
                    `;
                }

                // WhatsApp
                const whatsappBtn = document.getElementById('whatsapp-btn');
                if (whatsappBtn && settings.whatsapp) {
                    whatsappBtn.href = `https://wa.me/${settings.whatsapp.replace(/\D/g, '')}`;
                }

            } catch (error) {
                console.error('Erreur lors du chargement des infos de contact:', error);
                // Garder les valeurs par d√©faut en cas d'erreur
            }
        }

        // Gestion du formulaire
        function setupContactForm() {
            const contactForm = document.getElementById('contactForm');
            const successMessage = document.getElementById('successMessage');
            const submitBtn = contactForm.querySelector('.submit-btn');

            contactForm.addEventListener('submit', function(e) {
                e.preventDefault();

                // D√©sactiver le bouton
                submitBtn.disabled = true;
                submitBtn.textContent = 'Envoi en cours...';

                // Simuler l'envoi (remplacer par votre logique d'envoi r√©elle)
                setTimeout(() => {
                    // Afficher le message de succ√®s
                    successMessage.classList.add('show');
                    
                    // R√©initialiser le formulaire
                    contactForm.reset();
                    
                    // R√©activer le bouton
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Envoyer ma demande de devis';

                    // Faire d√©filer vers le message de succ√®s
                    successMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });

                    // Masquer le message apr√®s 5 secondes
                    setTimeout(() => {
                        successMessage.classList.remove('show');
                    }, 5000);
                }, 1500);
            });

            // Validation du t√©l√©phone (format fran√ßais)
            const telInput = document.querySelector('input[name="telephone"]');
            telInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/[^\d\s]/g, '');
                if (value.length >= 2) {
                    value = value.match(/.{1,2}/g).join(' ');
                }
                e.target.value = value;
            });

            // Validation du code postal
            const cpInput = document.querySelector('input[name="cp"]');
            cpInput.addEventListener('input', function(e) {
                e.target.value = e.target.value.replace(/\D/g, '').substring(0, 5);
            });
        }

        // Initialiser les animations
        function initAnimations() {
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, observerOptions);

            // Animer les √©l√©ments
            const animatedElements = document.querySelectorAll('.form-container, .info-card, .quick-actions');
            animatedElements.forEach((element, index) => {
                element.style.opacity = '0';
                element.style.transform = 'translateY(20px)';
                element.style.transition = `opacity 0.5s ease ${index * 0.05}s, transform 0.5s ease ${index * 0.05}s`;
                observer.observe(element);
            });
        }

        // Gestion Netlify Identity
        if (window.netlifyIdentity) {
            window.netlifyIdentity.on("init", user => {
                if (!user) {
                    window.netlifyIdentity.on("login", () => {
                        document.location.href = "/admin/";
                    });
                }
            });
        }
    </script>
</body>
</html>